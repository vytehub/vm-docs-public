"use strict";(self.webpackChunkvyte_merge_docs=self.webpackChunkvyte_merge_docs||[]).push([[8366],{28185:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"core-domain/bounded-contexts/Offer - Catalog & Listings/listing/capacity_shared_capacity","title":"Capacity","description":"Capacity, MinToConfirm y Shared Capacity para Service Listings.","source":"@site/docs/00-core-domain/04-bounded-contexts/03.Offer - Catalog & Listings/02.listing/06.capacity_shared_capacity.md","sourceDirName":"00-core-domain/04-bounded-contexts/03.Offer - Catalog & Listings/02.listing","slug":"/core-domain/bounded-contexts/Offer - Catalog & Listings/listing/capacity_shared_capacity","permalink":"/vm-docs-public/en/docs/core-domain/bounded-contexts/Offer - Catalog & Listings/listing/capacity_shared_capacity","draft":false,"unlisted":false,"editUrl":"https://github.com/vytehub/vm-docs/tree/main/docs/00-core-domain/04-bounded-contexts/03.Offer - Catalog & Listings/02.listing/06.capacity_shared_capacity.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Capacity","description":"Capacity, MinToConfirm y Shared Capacity para Service Listings."},"sidebar":"tutorialSidebar","previous":{"title":"Booking Rules","permalink":"/vm-docs-public/en/docs/core-domain/bounded-contexts/Offer - Catalog & Listings/listing/booking_rules"},"next":{"title":"Assignment","permalink":"/vm-docs-public/en/docs/core-domain/bounded-contexts/Offer - Catalog & Listings/listing/assignment_auto"}}');var c=i(74848),l=i(28453);const o={title:"Capacity",description:"Capacity, MinToConfirm y Shared Capacity para Service Listings."},d="Capacity & Shared Capacity",a={},r=[{value:"Tipo A: Pool fijo (Resource Pool)",id:"tipo-a-pool-fijo-resource-pool",level:2},{value:"Cu\xe1ndo aplica",id:"cu\xe1ndo-aplica",level:3},{value:"Variables",id:"variables",level:3},{value:"Solapamiento (overlap)",id:"solapamiento-overlap",level:3},{value:"Consumo y decisi\xf3n",id:"consumo-y-decisi\xf3n",level:3},{value:"Tipo B: Pool din\xe1mico (Skill/Staff Pool)",id:"tipo-b-pool-din\xe1mico-skillstaff-pool",level:2},{value:"Cu\xe1ndo aplica",id:"cu\xe1ndo-aplica-1",level:3},{value:"Concepto clave",id:"concepto-clave",level:3},{value:"Notaci\xf3n",id:"notaci\xf3n",level:3},{value:"Condici\xf3n de aceptaci\xf3n (matching)",id:"condici\xf3n-de-aceptaci\xf3n-matching",level:3},{value:"Ejemplo Nails (din\xe1mico)",id:"ejemplo-nails-din\xe1mico",level:3},{value:"Reglas pr\xe1cticas para el MVP",id:"reglas-pr\xe1cticas-para-el-mvp",level:2},{value:"\xbfQu\xe9 se valida en runtime?",id:"qu\xe9-se-valida-en-runtime",level:3},{value:"\xbfQu\xe9 bookings se cuentan?",id:"qu\xe9-bookings-se-cuentan",level:3},{value:"Revalidaci\xf3n al confirmar",id:"revalidaci\xf3n-al-confirmar",level:3},{value:"C\xf3mo convive con \u201cCapacity\u201d de Attendees",id:"c\xf3mo-convive-con-capacity-de-attendees",level:2}];function t(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"capacity--shared-capacity",children:"Capacity & Shared Capacity"})}),"\n",(0,c.jsxs)(n.p,{children:["En VyteMerge hay ",(0,c.jsx)(n.strong,{children:"dos formas"})," de \u201ccapacidad compartida\u201d:"]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Pool fijo (Resource Pool):"})," capacidad = n\xfamero fijo de recursos equivalentes",(0,c.jsx)(n.br,{}),"\n","(gabinetes, canchas, salas, equipos)."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Pool din\xe1mico (Skill/Staff Pool):"})," capacidad depende de ",(0,c.jsx)(n.strong,{children:"qui\xe9n puede hacer qu\xe9"})," y de lo ya reservado",(0,c.jsx)(n.br,{}),"\n","(ej: est\xe9tica nails con 3 empleadas y 3 servicios)."]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["Importante: esto es ",(0,c.jsx)(n.strong,{children:"capacidad de recurso"})," (qui\xe9n/qu\xe9 puede atender).",(0,c.jsx)(n.br,{}),"\n","No confundir con ",(0,c.jsx)(n.code,{children:"BookingCapacity"})," (cupos de asistentes) que se usa para Attendees (ej: partido de f\xfatbol 10)."]}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"tipo-a-pool-fijo-resource-pool",children:"Tipo A: Pool fijo (Resource Pool)"}),"\n",(0,c.jsx)(n.h3,{id:"cu\xe1ndo-aplica",children:"Cu\xe1ndo aplica"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Gabinetes id\xe9nticos: 3 salas de depilaci\xf3n equivalentes"}),"\n",(0,c.jsx)(n.li,{children:"Canchas: 2 canchas iguales"}),"\n",(0,c.jsx)(n.li,{children:"Equipos: 5 dispositivos iguales"}),"\n",(0,c.jsx)(n.li,{children:"\u201cUnidades\u201d indistinguibles"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"variables",children:"Variables"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"PoolCapacity"})," = capacidad total del pool (entero >= 1)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Interval"})," = intervalo del slot ",(0,c.jsx)(n.code,{children:"[start, end)"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"BookingsOverlapping(Interval)"})," = bookings que se solapan con el intervalo y consumen el pool"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Units(b)"})," = unidades consumidas por booking ",(0,c.jsx)(n.code,{children:"b"})," (default 1)"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"solapamiento-overlap",children:"Solapamiento (overlap)"}),"\n",(0,c.jsxs)(n.p,{children:["Un booking ",(0,c.jsx)(n.code,{children:"b"})," solapa con ",(0,c.jsx)(n.code,{children:"Interval"})," si:"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"b.start < Interval.end"})," ",(0,c.jsx)(n.strong,{children:"y"})," ",(0,c.jsx)(n.code,{children:"b.end > Interval.start"})]}),"\n",(0,c.jsxs)(n.p,{children:["(Usamos intervalos semiabiertos ",(0,c.jsx)(n.code,{children:"[start, end)"})," para evitar conflictos en bordes.)"]}),"\n",(0,c.jsx)(n.h3,{id:"consumo-y-decisi\xf3n",children:"Consumo y decisi\xf3n"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"PoolUsed(Interval) = \u03a3 Units(b)"})," para todo ",(0,c.jsx)(n.code,{children:"b"})," solapado"]}),"\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.code,{children:"PoolAvailable(Interval) = PoolCapacity - PoolUsed(Interval)"})}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Para una nueva reserva ",(0,c.jsx)(n.code,{children:"Units(newBooking)"}),":"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"canReserve = PoolAvailable(Interval) >= Units(newBooking)"})}),"\n",(0,c.jsxs)(n.p,{children:["Si ",(0,c.jsx)(n.code,{children:"canReserve"})," es false \u2192 slot ",(0,c.jsx)(n.strong,{children:"no disponible"})," (conflicto por capacidad)."]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"tipo-b-pool-din\xe1mico-skillstaff-pool",children:"Tipo B: Pool din\xe1mico (Skill/Staff Pool)"}),"\n",(0,c.jsx)(n.h3,{id:"cu\xe1ndo-aplica-1",children:"Cu\xe1ndo aplica"}),"\n",(0,c.jsxs)(n.p,{children:["Cuando el recurso no es \u201cun n\xfamero fijo\u201d, sino un conjunto de ",(0,c.jsx)(n.strong,{children:"personas con habilidades"}),":"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Est\xe9tica: empleadas con distintas combinaciones de servicios"}),"\n",(0,c.jsx)(n.li,{children:"Cl\xednica: m\xe9dicos con especialidades"}),"\n",(0,c.jsx)(n.li,{children:"Staff con certificaciones / skills"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["En este caso, \u201ccapacidad por servicio\u201d es ",(0,c.jsx)(n.strong,{children:"din\xe1mica"})," porque las personas se ocupan."]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"Ejemplo nails:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Empleada 1: ",(0,c.jsx)(n.code,{children:"A"}),", ",(0,c.jsx)(n.code,{children:"B"})]}),"\n",(0,c.jsxs)(n.li,{children:["Empleada 2: ",(0,c.jsx)(n.code,{children:"B"}),", ",(0,c.jsx)(n.code,{children:"C"})]}),"\n",(0,c.jsxs)(n.li,{children:["Empleada 3: ",(0,c.jsx)(n.code,{children:"A"}),", ",(0,c.jsx)(n.code,{children:"B"}),", ",(0,c.jsx)(n.code,{children:"C"}),(0,c.jsx)(n.br,{}),"\n","M\xe1ximos te\xf3ricos sin reservas: ",(0,c.jsx)(n.code,{children:"A=2"}),", ",(0,c.jsx)(n.code,{children:"B=3"}),", ",(0,c.jsx)(n.code,{children:"C=2"}),(0,c.jsx)(n.br,{}),"\n","Pero la capacidad real cambia seg\xfan lo reservado en ese horario."]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"concepto-clave",children:"Concepto clave"}),"\n",(0,c.jsxs)(n.p,{children:["No alcanza con \u201csumar capacities por servicio\u201d porque ",(0,c.jsxs)(n.strong,{children:[(0,c.jsx)(n.code,{children:"A"}),", ",(0,c.jsx)(n.code,{children:"B"})," y ",(0,c.jsx)(n.code,{children:"C"})," comparten el mismo pool real: las empleadas"]}),"."]}),"\n",(0,c.jsx)(n.p,{children:"La condici\xf3n correcta es:"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["Un nuevo booking es aceptable si existe una ",(0,c.jsx)(n.strong,{children:"asignaci\xf3n posible"})," de los bookings del intervalo a staff que pueda atenderlos."]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["Eso es un problema de ",(0,c.jsx)(n.strong,{children:"matching (emparejamiento)"}),"."]}),"\n",(0,c.jsx)(n.h3,{id:"notaci\xf3n",children:"Notaci\xf3n"}),"\n",(0,c.jsxs)(n.p,{children:["Para un intervalo ",(0,c.jsx)(n.code,{children:"I"}),":"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Staff"})," = conjunto de personas elegibles (empleadas)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Skill(e)"})," = servicios que puede hacer la empleada ",(0,c.jsx)(n.code,{children:"e"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Bookings(I)"})," = bookings existentes que solapan con ",(0,c.jsx)(n.code,{children:"I"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Service(b)"})," = servicio requerido por booking ",(0,c.jsx)(n.code,{children:"b"})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"condici\xf3n-de-aceptaci\xf3n-matching",children:"Condici\xf3n de aceptaci\xf3n (matching)"}),"\n",(0,c.jsxs)(n.p,{children:["Existe una funci\xf3n ",(0,c.jsx)(n.strong,{children:"inyectiva"}),":"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"assign : Bookings(I) \u222a {newBooking} -> StaffAvailable(I)"})}),"\n",(0,c.jsxs)(n.p,{children:["tal que para todo booking ",(0,c.jsx)(n.code,{children:"b"}),":"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"Service(b) \u2208 Skill(assign(b))"})}),"\n",(0,c.jsxs)(n.p,{children:["Si esa asignaci\xf3n existe \u2192 \u2705 reservable",(0,c.jsx)(n.br,{}),"\n","Si no existe \u2192 \u274c no reservable"]}),"\n",(0,c.jsx)(n.p,{children:"Equivalente pr\xe1ctico:"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"maxMatchingSize == numberOfBookingsInInterval"})}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"ejemplo-nails-din\xe1mico",children:"Ejemplo Nails (din\xe1mico)"}),"\n",(0,c.jsx)(n.p,{children:"Skills:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["E1: ",(0,c.jsx)(n.code,{children:"{A, B}"})]}),"\n",(0,c.jsxs)(n.li,{children:["E2: ",(0,c.jsx)(n.code,{children:"{B, C}"})]}),"\n",(0,c.jsxs)(n.li,{children:["E3: ",(0,c.jsx)(n.code,{children:"{A, B, C}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"M\xe1ximo te\xf3rico (sin reservas):"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Max(A) = 2"})," (E1, E3)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Max(B) = 3"})," (E1, E2, E3)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Max(C) = 2"})," (E2, E3)"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Caso 1:"})," ya hay 2 bookings de ",(0,c.jsx)(n.code,{children:"A"})," en el mismo intervalo"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["asignaci\xf3n posible: ",(0,c.jsx)(n.code,{children:"A\u2192E1"})," y ",(0,c.jsx)(n.code,{children:"A\u2192E3"})]}),"\n",(0,c.jsxs)(n.li,{children:["queda libre solo ",(0,c.jsx)(n.code,{children:"E2"})," (",(0,c.jsx)(n.code,{children:"B"}),",",(0,c.jsx)(n.code,{children:"C"}),")"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Entonces en ese mismo intervalo:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"A"})," disponible: 0"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"B"})," disponible: 1"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"C"})," disponible: 1"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Caso 2:"})," ya hay 2 bookings de ",(0,c.jsx)(n.code,{children:"C"})," en el mismo intervalo"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["asignaci\xf3n posible: ",(0,c.jsx)(n.code,{children:"C\u2192E2"})," y ",(0,c.jsx)(n.code,{children:"C\u2192E3"})]}),"\n",(0,c.jsxs)(n.li,{children:["queda libre solo ",(0,c.jsx)(n.code,{children:"E1"})," (",(0,c.jsx)(n.code,{children:"A"}),",",(0,c.jsx)(n.code,{children:"B"}),")"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Entonces:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"A"})," disponible: 1"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"B"})," disponible: 1"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"C"})," disponible: 0"]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["Resultado: aunque \u201c",(0,c.jsx)(n.code,{children:"B"})," te\xf3rico\u201d sea 3, puede caer a 1 si ",(0,c.jsx)(n.code,{children:"A"})," o ",(0,c.jsx)(n.code,{children:"C"})," ya consumieron staff."]}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"reglas-pr\xe1cticas-para-el-mvp",children:"Reglas pr\xe1cticas para el MVP"}),"\n",(0,c.jsx)(n.h3,{id:"qu\xe9-se-valida-en-runtime",children:"\xbfQu\xe9 se valida en runtime?"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Pool fijo:"})," validar con la f\xf3rmula simple."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Pool din\xe1mico:"})," validar con matching sobre el intervalo (staff disponible + skills)."]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"qu\xe9-bookings-se-cuentan",children:"\xbfQu\xe9 bookings se cuentan?"}),"\n",(0,c.jsx)(n.p,{children:"Recomendaci\xf3n (consistente con evitar overbooking):"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["contar ",(0,c.jsx)(n.strong,{children:"Confirmed"})," + ",(0,c.jsx)(n.strong,{children:"Pending"})," (los que ya bloquearon \u201ctentativamente\u201d)"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"revalidaci\xf3n-al-confirmar",children:"Revalidaci\xf3n al confirmar"}),"\n",(0,c.jsx)(n.p,{children:"Siempre revalidar al confirmar booking para evitar race conditions:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"slots son proyecci\xf3n, booking es verdad."}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"c\xf3mo-convive-con-capacity-de-attendees",children:"C\xf3mo convive con \u201cCapacity\u201d de Attendees"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"BookingCapacity"})," / ",(0,c.jsx)(n.code,{children:"MinToConfirm"})," / ",(0,c.jsx)(n.code,{children:"Attendees"})," \u2192 ",(0,c.jsx)(n.strong,{children:"cupos de participantes"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Shared Capacity Pool"})," \u2192 ",(0,c.jsx)(n.strong,{children:"capacidad de recursos (staff/salas/equipos)"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"Ejemplos:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["F\xfatbol 5:","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"BookingCapacity=10"})," (attendees)"]}),"\n",(0,c.jsx)(n.li,{children:"Pool fijo: cancha (1)"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["Nails:","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.code,{children:"BookingCapacity=1"})}),"\n",(0,c.jsx)(n.li,{children:"Pool din\xe1mico: staff por skills"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(t,{...e})}):t(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var s=i(96540);const c={},l=s.createContext(c);function o(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);